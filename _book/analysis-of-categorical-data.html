<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 14 Analysis of categorical data | Medical Statistics using R</title>
<meta name="author" content="Samuel Blay Nguah">
<meta name="description" content="In this section we discuss how to analyse categorical data, both aggregated and non-aggregated.  14.1 One-sample binomial test  14.1.1 One sample proportion: Confidence interval In a study to...">
<meta name="generator" content="bookdown 0.34 with bs4_book()">
<meta property="og:title" content="Chapter 14 Analysis of categorical data | Medical Statistics using R">
<meta property="og:type" content="book">
<meta property="og:url" content="https://medstastwithr.netlify.app/analysis-of-categorical-data.html">
<meta property="og:description" content="In this section we discuss how to analyse categorical data, both aggregated and non-aggregated.  14.1 One-sample binomial test  14.1.1 One sample proportion: Confidence interval In a study to...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 14 Analysis of categorical data | Medical Statistics using R">
<meta name="twitter:description" content="In this section we discuss how to analyse categorical data, both aggregated and non-aggregated.  14.1 One-sample binomial test  14.1.1 One sample proportion: Confidence interval In a study to...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.5.0/transition.js"></script><script src="libs/bs3compat-0.5.0/tabs.js"></script><script src="libs/bs3compat-0.5.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="libs/tabwid-1.1.3/tabwid.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Medical Statistics using R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> About</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">2</span> Introduction</a></li>
<li><a class="" href="statistical-data-types.html"><span class="header-section-number">3</span> Statistical data types</a></li>
<li><a class="" href="r-data-types.html"><span class="header-section-number">4</span> R data types</a></li>
<li><a class="" href="data-structures-in-r.html"><span class="header-section-number">5</span> Data Structures in R</a></li>
<li><a class="" href="importing-data-into-r.html"><span class="header-section-number">6</span> Importing data into R</a></li>
<li><a class="" href="data-wrangling.html"><span class="header-section-number">7</span> Data wrangling</a></li>
<li><a class="" href="data-cleaning.html"><span class="header-section-number">8</span> Data Cleaning</a></li>
<li><a class="" href="descriptive-statistics-categorical.html"><span class="header-section-number">9</span> Descriptive Statistics: Categorical</a></li>
<li><a class="" href="descriptive-statistics-numeric.html"><span class="header-section-number">10</span> Descriptive Statistics: Numeric</a></li>
<li><a class="" href="hypothesis-testing.html"><span class="header-section-number">11</span> Hypothesis-Testing</a></li>
<li><a class="" href="normality-of-data.html"><span class="header-section-number">12</span> Normality of data</a></li>
<li><a class="" href="analysis-of-numeric-data.html"><span class="header-section-number">13</span> Analysis of numeric data</a></li>
<li><a class="active" href="analysis-of-categorical-data.html"><span class="header-section-number">14</span> Analysis of categorical data</a></li>
<li><a class="" href="risk-and-odds.html"><span class="header-section-number">15</span> Risk and Odds</a></li>
<li><a class="" href="confounding-and-interaction.html"><span class="header-section-number">16</span> Confounding and Interaction</a></li>
<li><a class="" href="diagnostic-tests.html"><span class="header-section-number">17</span> Diagnostic Tests</a></li>
<li><a class="" href="agreement.html"><span class="header-section-number">18</span> Agreement</a></li>
<li><a class="" href="receiver-operating-characteristic.html"><span class="header-section-number">19</span> Receiver Operating Characteristic</a></li>
<li><a class="" href="linear-regression.html"><span class="header-section-number">20</span> Linear Regression</a></li>
<li><a class="" href="logistic-regression.html"><span class="header-section-number">21</span> Logistic Regression</a></li>
<li><a class="" href="analysis-of-variance.html"><span class="header-section-number">22</span> Analysis of Variance</a></li>
<li><a class="" href="ancova-manova.html"><span class="header-section-number">23</span> ANCOVA &amp; MANOVA</a></li>
<li><a class="" href="ordinal-logistic-regression.html"><span class="header-section-number">24</span> Ordinal logistic regression</a></li>
<li><a class="" href="survival-analysis.html"><span class="header-section-number">25</span> Survival analysis</a></li>
<li><a class="" href="cox-regression-1.html"><span class="header-section-number">26</span> Cox Regression</a></li>
<li><a class="" href="blocks.html"><span class="header-section-number">27</span> Blocks</a></li>
<li><a class="" href="footnotes-and-citations.html"><span class="header-section-number">28</span> Footnotes and citations</a></li>
<li><a class="" href="cross.html"><span class="header-section-number">29</span> Cross-references</a></li>
<li><a class="" href="parts.html"><span class="header-section-number">30</span> Parts</a></li>
<li><a class="" href="sharing-your-book.html"><span class="header-section-number">31</span> Sharing your book</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/sbnguah/MedStatsBook">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="analysis-of-categorical-data" class="section level1" number="14">
<h1>
<span class="header-section-number">14</span> Analysis of categorical data<a class="anchor" aria-label="anchor" href="#analysis-of-categorical-data"><i class="fas fa-link"></i></a>
</h1>
<p>In this section we discuss how to analyse categorical data, both aggregated and non-aggregated.</p>
<div id="one-sample-binomial-test" class="section level2" number="14.1">
<h2>
<span class="header-section-number">14.1</span> One-sample binomial test<a class="anchor" aria-label="anchor" href="#one-sample-binomial-test"><i class="fas fa-link"></i></a>
</h2>
<div id="one-sample-proportion-confidence-interval" class="section level3" number="14.1.1">
<h3>
<span class="header-section-number">14.1.1</span> One sample proportion: Confidence interval<a class="anchor" aria-label="anchor" href="#one-sample-proportion-confidence-interval"><i class="fas fa-link"></i></a>
</h3>
<p>In a study to determine the prevalence of hypertension in a certain adult
population, a random sample taken revealed 23 out of 67 had hypertension. The
proportion of hypertensive patients in the sample is rather straightforward.
Approximately 0.34 or (34.3%) of the sample are hypertensives. We however
extrapolate to estimate this proportion in the population by estimating the
confidence interval. To do this single proportion estimation we use the
<code><a href="https://rdrr.io/r/stats/binom.test.html">binom.test()</a></code> function after we have fulfilled the conditions required for its
use. These are:</p>
<ul>
<li>The sample was obtained by simple random sampling</li>
<li>There are just two possible outcomes for the data, here hypertension (successes) or no
hypertension (failures).</li>
<li>The sample includes at least 10 successes and 10 failures</li>
<li>The population is at least 20 times larger than the sample size.</li>
</ul>
<p>With our sample not violating these conditions, we go ahead to use the one-sample
binomial test as below:</p>
<div class="sourceCode" id="cb174"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/binom.test.html">binom.test</a></span><span class="op">(</span><span class="fl">23</span>, <span class="fl">67</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/generics/man/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">method</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-2">
<caption style="caption-side: top; text-align: center;">
<span id="tab:unnamed-chunk-2">Table 7.1: </span> </caption>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 0pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">estimate</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">statistic</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">p.value</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">parameter</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">conf.low</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">conf.high</th>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">alternative</th>
</tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 0pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">0.343</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">23</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">0.0139</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">67</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">0.232</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">0.469</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">two.sided</td>
</tr>
</table></div>
<p>The binomial exact confidence interval of the proportion of those with hypertension in our
study population, therefore, is 23.2% to 46.9%.</p>
</div>
<div id="one-sample-proportion-hypothesis-testing" class="section level3" number="14.1.2">
<h3>
<span class="header-section-number">14.1.2</span> One sample proportion: Hypothesis testing<a class="anchor" aria-label="anchor" href="#one-sample-proportion-hypothesis-testing"><i class="fas fa-link"></i></a>
</h3>
<p>Before the data on hypertension above was collected, the investigator<br>
hypothesized that 50% of the population was hypertensive. Next, we test this
hypothesis. As usual, we start by setting the null hypothesis.</p>
<blockquote>
<p>H0: The population proportion of hypertensive in the population is 50%</p>
</blockquote>
<div class="sourceCode" id="cb175"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/binom.test.html">binom.test</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">23</span>, n<span class="op">=</span><span class="fl">67</span>, p<span class="op">=</span><span class="fl">.5</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/generics/man/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span><span class="op">%&gt;%</span> </span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">method</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-3">
<caption style="caption-side: top; text-align: center;">
<span id="tab:unnamed-chunk-3">Table 7.2: </span> </caption>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 0pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">estimate</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">statistic</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">p.value</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">parameter</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">conf.low</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">conf.high</th>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">alternative</th>
</tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 0pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">0.343</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">23</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">0.0139</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">67</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">0.232</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">0.469</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">two.sided</td>
</tr>
</table></div>
<p>It would be realised that this p-value is identical to that in the last
computation. This is because the <code><a href="https://rdrr.io/r/stats/binom.test.html">binom.test()</a></code> by default tests the proportion
against a 50:50 proportion in the population. At a 5% significance level, we
reject H0 and conclude the proportion of hypertensive in our population
significantly differs from 50%.</p>
<p>So, what if the investigators had hypothesized that prevalence in the population
is 40%? Our null hypothesis would then have been:</p>
<blockquote>
<p>H0: The population proportion of hypertensive is 40%</p>
</blockquote>
<p>Next, we test this hypothesis.</p>
<div class="sourceCode" id="cb176"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/binom.test.html">binom.test</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">23</span>, n<span class="op">=</span><span class="fl">67</span>, p<span class="op">=</span><span class="fl">.4</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/generics/man/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span><span class="op">%&gt;%</span> </span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">method</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-4">
<caption style="caption-side: top; text-align: center;">
<span id="tab:unnamed-chunk-4">Table 6.1: </span> </caption>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 0pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">estimate</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">statistic</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">p.value</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">parameter</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">conf.low</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">conf.high</th>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">alternative</th>
</tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 0pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">0.343</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">23</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">0.384</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">67</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">0.232</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">0.469</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">two.sided</td>
</tr>
</table></div>
<p>At a significance level of 0.05, we fail to reject the null hypothesis,
concluding that there is insufficient evidence to conclude our population
prevalence is not 40%.</p>
<p>Finally, what if the investigators had hypothesized that the population
prevalence of hypertension is at least 47%? Remember this is a one-sided test
and our null hypothesis would be</p>
<blockquote>
<p>H0: The population proportion of hypertension is greater than or equal to 47%</p>
</blockquote>
<p>And then we test the hypothesis</p>
<div class="sourceCode" id="cb177"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/binom.test.html">binom.test</a></span><span class="op">(</span><span class="fl">23</span>, <span class="fl">67</span>, p<span class="op">=</span><span class="fl">.47</span>, alternative <span class="op">=</span> <span class="st">"less"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/generics/man/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span><span class="op">%&gt;%</span> </span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">method</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-5">
<caption style="caption-side: top; text-align: center;">
<span id="tab:unnamed-chunk-5">Table 7.3: </span> </caption>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 0pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">estimate</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">statistic</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">p.value</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">parameter</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">conf.low</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">conf.high</th>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">alternative</th>
</tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 0pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">0.343</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">23</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">0.0244</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">67</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">0</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">0.45</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">less</td>
</tr>
</table></div>
<p>The small p-value leads us to reject H0 and conclude it is insufficient
evidence to support the assertion that the prevalence of hypertension in the population is at least 47%.</p>
</div>
</div>
<div id="two-or-more-sample-binomial-test" class="section level2" number="14.2">
<h2>
<span class="header-section-number">14.2</span> Two or more sample binomial test<a class="anchor" aria-label="anchor" href="#two-or-more-sample-binomial-test"><i class="fas fa-link"></i></a>
</h2>
<div id="two-sample-proportion-hypothesis-testing" class="section level3" number="14.2.1">
<h3>
<span class="header-section-number">14.2.1</span> Two sample proportion: Hypothesis testing<a class="anchor" aria-label="anchor" href="#two-sample-proportion-hypothesis-testing"><i class="fas fa-link"></i></a>
</h3>
<p>Taking it further we decide to select from a different population and sample 100
persons to determine the proportion of those with hypertension. In this
population, we came up with 52 hypertension patients out of a hundred. We aim to compare if there is a significant difference between the proportion of
hypertension patients in the two populations. To do this we use the
<code><a href="https://rdrr.io/r/stats/prop.test.html">prop.test()</a></code> function in R.</p>
<p>First, we state the null hypothesis:
&gt;H0: The population proportion of hypertension in both populations are the same.</p>
<p>Next, we test the hypothesis. To do this we first create two vectors
representing the number of persons with hypertension and the total samples
chosen.</p>
<div class="sourceCode" id="cb178"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hpt</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">52</span>, <span class="fl">23</span><span class="op">)</span> <span class="co"># Vector of numbers with hypertension</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">67</span><span class="op">)</span> <span class="co"># Vector of numbers in the sample</span></span></code></pre></div>
<p>Next, we apply the test</p>
<div class="sourceCode" id="cb179"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">hpt</span>, n <span class="op">=</span> <span class="va">n</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/generics/man/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span><span class="op">%&gt;%</span> </span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">method</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-7">
<caption style="caption-side: top; text-align: center;">
<span id="tab:unnamed-chunk-7">Table 6.3: </span> </caption>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 0pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">estimate1</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">estimate2</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">statistic</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">p.value</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">parameter</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">conf.low</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">conf.high</th>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">alternative</th>
</tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 0pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">0.52</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">0.343</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">4.37</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">0.0365</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">1</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">0.0142</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">0.339</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">two.sided</td>
</tr>
</table></div>
<p>p-value of 0.0365 is less than our regular significance level of 0.05 so we
reject the null hypothesis and say there is enough evidence to conclude that
the prevalence of hypertension is not the same in the two populations.</p>
<p>The 95% confidence interval generated above is that of the difference between
the two proportions, which is 0.177. The confidence interval of 0.014 to 0.339
does not include the null value 0 so we conclude that there is a difference in
the prevalence of hypertension between the 2 populations.</p>
</div>
</div>
<div id="chi-squared-test" class="section level2" number="14.3">
<h2>
<span class="header-section-number">14.3</span> Chi-squared test<a class="anchor" aria-label="anchor" href="#chi-squared-test"><i class="fas fa-link"></i></a>
</h2>
<p>Pearson’s chi-square test, also known as the chi-square goodness-of-fit test or
chi-square test for independence is used to determine if observed frequencies in
data are consistent with what is expected. For instance, in Asia, the
percentages of ABO blood groups in the population are 38%, 10%, 3% and 49% for
groups A, B, AB, and O respectively. In a random sample of 600 persons in Kumasi,
Ghana 226, 82, 21 and 271 were blood groups A, B, AB, and O respectively.
The chi-squared test can help us determine if the proportion of blood groups
found in Kumasi is consistent with that seen in Asia.</p>
<div id="chi-squared-goodness-of-fit-test" class="section level3" number="14.3.1">
<h3>
<span class="header-section-number">14.3.1</span> Chi-squared goodness of fit test<a class="anchor" aria-label="anchor" href="#chi-squared-goodness-of-fit-test"><i class="fas fa-link"></i></a>
</h3>
<p>In the blood group example above the investigators may want to know if the
proportions of the blood groups in Kumasi are consistent with that seen in Asia.
To do this we use the Chi-squared goodness of fit test. As always, we begin by
making sure the test can be appropriately used under this condition. The
assumptions of the test are:</p>
<ul>
<li>The data was obtained randomly from the population</li>
<li>The variable under study is categorical</li>
<li>Each of the observed values in each category is at least 5</li>
</ul>
<p>With none of the conditions violated we go ahead to state the null hypothesis as</p>
<blockquote>
<p>H0: The distribution of blood groups in Kumasi is not different from that in Asia.</p>
</blockquote>
<p>Next, we perform the test but to do that we first create a data frame of the
expected and observed frequencies in Asia and Kumasi respectively.</p>
<div class="sourceCode" id="cb180"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bld_grp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"AB"</span>, <span class="st">"O"</span><span class="op">)</span></span>
<span><span class="va">Asia</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">38.0</span>, <span class="fl">10.0</span>, <span class="fl">3.0</span>, <span class="fl">49.9</span><span class="op">)</span></span>
<span><span class="va">Kumasi</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">226</span>, <span class="fl">82</span>, <span class="fl">21</span>, <span class="fl">271</span><span class="op">)</span></span>
<span><span class="va">Kumasi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">Kumasi</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Kumasi</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">df_temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">bld_grp</span>, <span class="va">Asia</span>, <span class="va">Kumasi</span><span class="op">)</span></span>
<span><span class="va">df_temp</span></span></code></pre></div>
<div class="inline-table"><table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-8">
<caption style="caption-side: top; text-align: center;">
<span id="tab:unnamed-chunk-8">Table 7.4: </span> </caption>
<col>
<col>
<col>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 0pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">bld_grp</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">Asia</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">Kumasi</th>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 6pt 2pt 0pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">A</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">38  </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">37.7</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 6pt 2pt 0pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">B</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">10  </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">13.7</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 6pt 2pt 0pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">AB</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">3  </td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 2pt 0pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">3.5</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 0pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">O</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">49.9</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">45.2</td>
</tr>
</table></div>
<p>Next, we illustrate these proportions using a barplot by plotting the same blood
groups from different regions side by side.</p>
<div class="sourceCode" id="cb181"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_temp</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">pivot_longer</span><span class="op">(</span></span>
<span>        cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Asia</span>, <span class="va">Kumasi</span><span class="op">)</span>, </span>
<span>        names_to <span class="op">=</span> <span class="st">"Place"</span>, </span>
<span>        values_to <span class="op">=</span> <span class="st">"Perc"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span></span>
<span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">Perc</span>,<span class="fl">1</span><span class="op">)</span>, nsmall<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, <span class="st">"%"</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">bld_grp</span>, y <span class="op">=</span> <span class="va">Perc</span>, fill <span class="op">=</span> <span class="va">Place</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span>, position<span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_text</span><span class="op">(</span></span>
<span>        <span class="fu">aes</span><span class="op">(</span>label<span class="op">=</span><span class="va">labels</span><span class="op">)</span>, vjust<span class="op">=</span><span class="fl">1.5</span>, color<span class="op">=</span><span class="st">"black"</span>, </span>
<span>        size<span class="op">=</span><span class="fl">3.5</span>, position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="fl">0.9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_fill_brewer</span><span class="op">(</span>palette<span class="op">=</span><span class="st">"Blues"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">labs</span><span class="op">(</span></span>
<span>        title<span class="op">=</span><span class="st">"Comparative distribution of Blood Groups"</span>, </span>
<span>        x <span class="op">=</span> <span class="st">"Blood Group"</span>, </span>
<span>        y <span class="op">=</span> <span class="st">"Frequency"</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Analysis-of-categorical-data_files/figure-html/unnamed-chunk-9-1.png" width="624"></div>
<p>We observe the similarities between the proportions from Kumasi and Asia. For
instance, the blood groups from both regions show decreasing frequency from O,
A, B and AB. However, we also observe that adjacent bars are not exactly of the
same height. Blood groups O and B for instance have approximately a 4%-point
difference between the two populations. Next, we perform the actual test for
the difference in proportions.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="analysis-of-categorical-data.html#cb182-1" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="at">x =</span> Kumasi, <span class="at">p =</span> Asia<span class="sc">/</span><span class="fu">sum</span>(Asia)) <span class="sc">%&gt;%</span> </span>
<span id="cb182-2"><a href="analysis-of-categorical-data.html#cb182-2" tabindex="-1"></a>    broom<span class="sc">::</span><span class="fu">tidy</span>()</span>
<span id="cb182-3"><a href="analysis-of-categorical-data.html#cb182-3" tabindex="-1"></a>Warning <span class="cf">in</span> <span class="fu">chisq.test</span>(<span class="at">x =</span> Kumasi, <span class="at">p =</span> Asia<span class="sc">/</span><span class="fu">sum</span>(Asia))<span class="sc">:</span></span>
<span id="cb182-4"><a href="analysis-of-categorical-data.html#cb182-4" tabindex="-1"></a>Chi<span class="sc">-</span>squared approximation may be incorrect</span></code></pre></div>
<div class="inline-table"><table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-10">
<caption style="caption-side: top; text-align: center;">
<span id="tab:unnamed-chunk-10">Table 6.5: </span> </caption>
<col>
<col>
<col>
<col>
<tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 0pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">statistic</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">p.value</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">parameter</th>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">method</th>
</tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 0pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">1.91</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">0.592</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">3</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">Chi-squared test for given probabilities</td>
</tr>
</table></div>
<p>With a p-value of 0.592, we fail to reject H0 and conclude there is no evidence
that the proportions of blood groups in Kumasi are different from the observed
proportions in Asia.</p>
</div>
<div id="chi-squared-test-for-independent-data" class="section level3" number="14.3.2">
<h3>
<span class="header-section-number">14.3.2</span> Chi-squared test for independent data<a class="anchor" aria-label="anchor" href="#chi-squared-test-for-independent-data"><i class="fas fa-link"></i></a>
</h3>
<p>In this subsection, we will use the ANCdata from the epicalc package. It can also<br>
be obtained from the list of data that comes with this book. The ANCdata
contains records of high-risk pregnant women in a trial to compare a new and an
old method of antenatal care (anc) in two clinics (clinic). The outcome was
perinatal mortality, the death of the baby within the first week of life (death).</p>
<p>We begin by loading the ANCdata</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="analysis-of-categorical-data.html#cb183-1" tabindex="-1"></a>df_anc <span class="ot">&lt;-</span> </span>
<span id="cb183-2"><a href="analysis-of-categorical-data.html#cb183-2" tabindex="-1"></a>    <span class="fu">read.delim</span>(<span class="st">"./Data/ANCData.txt"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb183-3"><a href="analysis-of-categorical-data.html#cb183-3" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb183-4"><a href="analysis-of-categorical-data.html#cb183-4" tabindex="-1"></a>        <span class="at">death =</span> <span class="fu">factor</span>(death, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"no"</span>,<span class="st">"yes"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)),</span>
<span id="cb183-5"><a href="analysis-of-categorical-data.html#cb183-5" tabindex="-1"></a>        <span class="at">clinic =</span> <span class="fu">factor</span>(clinic),</span>
<span id="cb183-6"><a href="analysis-of-categorical-data.html#cb183-6" tabindex="-1"></a>        <span class="at">anc =</span> <span class="fu">factor</span>(anc, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"old"</span>, <span class="st">"new"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Old"</span>, <span class="st">"New"</span>)))</span>
<span id="cb183-7"><a href="analysis-of-categorical-data.html#cb183-7" tabindex="-1"></a></span>
<span id="cb183-8"><a href="analysis-of-categorical-data.html#cb183-8" tabindex="-1"></a>df_anc <span class="sc">%&gt;%</span> summarytools<span class="sc">::</span><span class="fu">dfSummary</span>(<span class="at">graph.col =</span> <span class="cn">FALSE</span>)</span>
<span id="cb183-9"><a href="analysis-of-categorical-data.html#cb183-9" tabindex="-1"></a>Data Frame Summary  </span>
<span id="cb183-10"><a href="analysis-of-categorical-data.html#cb183-10" tabindex="-1"></a>df_anc  </span>
<span id="cb183-11"><a href="analysis-of-categorical-data.html#cb183-11" tabindex="-1"></a>Dimensions<span class="sc">:</span> <span class="dv">755</span> x <span class="dv">3</span>  </span>
<span id="cb183-12"><a href="analysis-of-categorical-data.html#cb183-12" tabindex="-1"></a>Duplicates<span class="sc">:</span> <span class="dv">747</span>  </span>
<span id="cb183-13"><a href="analysis-of-categorical-data.html#cb183-13" tabindex="-1"></a></span>
<span id="cb183-14"><a href="analysis-of-categorical-data.html#cb183-14" tabindex="-1"></a><span class="sc">--------------------------------------------------------------------------</span></span>
<span id="cb183-15"><a href="analysis-of-categorical-data.html#cb183-15" tabindex="-1"></a>No   Variable   Stats <span class="sc">/</span> Values   <span class="fu">Freqs</span> (% of Valid)   Valid      Missing  </span>
<span id="cb183-16"><a href="analysis-of-categorical-data.html#cb183-16" tabindex="-1"></a><span class="sc">----</span> <span class="sc">----------</span> <span class="sc">----------------</span> <span class="sc">--------------------</span> <span class="sc">----------</span> <span class="sc">---------</span></span>
<span id="cb183-17"><a href="analysis-of-categorical-data.html#cb183-17" tabindex="-1"></a><span class="dv">1</span>    death      <span class="fl">1.</span> No            <span class="dv">689</span> (<span class="fl">91.3</span>%)          <span class="dv">755</span>        <span class="dv">0</span>        </span>
<span id="cb183-18"><a href="analysis-of-categorical-data.html#cb183-18" tabindex="-1"></a>     [factor]   <span class="fl">2.</span> Yes            <span class="dv">66</span> ( <span class="fl">8.7</span><span class="sc">%)          (100.0%</span>)   (<span class="fl">0.0</span>%)   </span>
<span id="cb183-19"><a href="analysis-of-categorical-data.html#cb183-19" tabindex="-1"></a></span>
<span id="cb183-20"><a href="analysis-of-categorical-data.html#cb183-20" tabindex="-1"></a><span class="dv">2</span>    anc        <span class="fl">1.</span> Old           <span class="dv">419</span> (<span class="fl">55.5</span>%)          <span class="dv">755</span>        <span class="dv">0</span>        </span>
<span id="cb183-21"><a href="analysis-of-categorical-data.html#cb183-21" tabindex="-1"></a>     [factor]   <span class="fl">2.</span> New           <span class="dv">336</span> (<span class="fl">44.5</span><span class="sc">%)          (100.0%</span>)   (<span class="fl">0.0</span>%)   </span>
<span id="cb183-22"><a href="analysis-of-categorical-data.html#cb183-22" tabindex="-1"></a></span>
<span id="cb183-23"><a href="analysis-of-categorical-data.html#cb183-23" tabindex="-1"></a><span class="dv">3</span>    clinic     <span class="fl">1.</span> A             <span class="dv">497</span> (<span class="fl">65.8</span>%)          <span class="dv">755</span>        <span class="dv">0</span>        </span>
<span id="cb183-24"><a href="analysis-of-categorical-data.html#cb183-24" tabindex="-1"></a>     [factor]   <span class="fl">2.</span> B             <span class="dv">258</span> (<span class="fl">34.2</span><span class="sc">%)          (100.0%</span>)   (<span class="fl">0.0</span>%)   </span>
<span id="cb183-25"><a href="analysis-of-categorical-data.html#cb183-25" tabindex="-1"></a><span class="sc">--------------------------------------------------------------------------</span></span></code></pre></div>
<p>Our objective in this section is to determine if there is a significant
relationship between the anc type and perinatal death. In other words, does
perinatal mortality differ in the population depending on the anc method used?</p>
<p>To begin we cross-tabulate the two variables.</p>
<div class="sourceCode" id="cb184"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_anc</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">tbl_cross</span><span class="op">(</span>percent <span class="op">=</span> <span class="st">"col"</span>,</span>
<span>        row <span class="op">=</span> <span class="va">death</span>, </span>
<span>        col <span class="op">=</span> <span class="va">anc</span>, </span>
<span>        label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">death</span> <span class="op">~</span> <span class="st">"Death"</span>, anc <span class="op">=</span> <span class="st">"ANC"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">bold_labels</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div id="hhljhjqcvf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#hhljhjqcvf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#hhljhjqcvf thead, #hhljhjqcvf tbody, #hhljhjqcvf tfoot, #hhljhjqcvf tr, #hhljhjqcvf td, #hhljhjqcvf th {
  border-style: none;
}

#hhljhjqcvf p {
  margin: 0;
  padding: 0;
}

#hhljhjqcvf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hhljhjqcvf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#hhljhjqcvf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hhljhjqcvf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hhljhjqcvf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hhljhjqcvf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hhljhjqcvf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hhljhjqcvf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hhljhjqcvf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hhljhjqcvf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hhljhjqcvf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hhljhjqcvf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hhljhjqcvf .gt_spanner_row {
  border-bottom-style: hidden;
}

#hhljhjqcvf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#hhljhjqcvf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hhljhjqcvf .gt_from_md > :first-child {
  margin-top: 0;
}

#hhljhjqcvf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hhljhjqcvf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hhljhjqcvf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#hhljhjqcvf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hhljhjqcvf .gt_row_group_first td {
  border-top-width: 2px;
}

#hhljhjqcvf .gt_row_group_first th {
  border-top-width: 2px;
}

#hhljhjqcvf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hhljhjqcvf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hhljhjqcvf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hhljhjqcvf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hhljhjqcvf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hhljhjqcvf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hhljhjqcvf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#hhljhjqcvf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hhljhjqcvf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hhljhjqcvf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hhljhjqcvf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hhljhjqcvf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hhljhjqcvf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hhljhjqcvf .gt_left {
  text-align: left;
}

#hhljhjqcvf .gt_center {
  text-align: center;
}

#hhljhjqcvf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hhljhjqcvf .gt_font_normal {
  font-weight: normal;
}

#hhljhjqcvf .gt_font_bold {
  font-weight: bold;
}

#hhljhjqcvf .gt_font_italic {
  font-style: italic;
}

#hhljhjqcvf .gt_super {
  font-size: 65%;
}

#hhljhjqcvf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#hhljhjqcvf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hhljhjqcvf .gt_indent_1 {
  text-indent: 5px;
}

#hhljhjqcvf .gt_indent_2 {
  text-indent: 10px;
}

#hhljhjqcvf .gt_indent_3 {
  text-indent: 15px;
}

#hhljhjqcvf .gt_indent_4 {
  text-indent: 20px;
}

#hhljhjqcvf .gt_indent_5 {
  text-indent: 25px;
}
</style>
<div class="inline-table"><table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings gt_spanner_row">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" scope="col" id=""></th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup" id="&lt;strong&gt;ANC&lt;/strong&gt;">
        <span class="gt_column_spanner"><strong>ANC</strong></span>
      </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="2" colspan="1" scope="col" id="&lt;strong&gt;Total&lt;/strong&gt;"><strong>Total</strong></th>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Old">Old</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="New">New</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td headers="label" class="gt_row gt_left" style="font-weight: bold;">Death</td>
<td headers="stat_1" class="gt_row gt_center"></td>
<td headers="stat_2" class="gt_row gt_center"></td>
<td headers="stat_0" class="gt_row gt_center"></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    No</td>
<td headers="stat_1" class="gt_row gt_center">373 (89%)</td>
<td headers="stat_2" class="gt_row gt_center">316 (94%)</td>
<td headers="stat_0" class="gt_row gt_center">689 (91%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    Yes</td>
<td headers="stat_1" class="gt_row gt_center">46 (11%)</td>
<td headers="stat_2" class="gt_row gt_center">20 (6.0%)</td>
<td headers="stat_0" class="gt_row gt_center">66 (8.7%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left" style="font-weight: bold;">Total</td>
<td headers="stat_1" class="gt_row gt_center">419 (100%)</td>
<td headers="stat_2" class="gt_row gt_center">336 (100%)</td>
<td headers="stat_0" class="gt_row gt_center">755 (100%)</td>
</tr>
</tbody>
</table></div>
</div>
<div class="sourceCode" id="cb185"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_anc</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">death</span>, <span class="va">anc</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">count</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">death</span>, y <span class="op">=</span> <span class="va">n</span>, x <span class="op">=</span> <span class="va">anc</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span>, stat <span class="op">=</span> <span class="st">"identity"</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_fill_discrete</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Death"</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"white"</span>,<span class="st">"red"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span></span>
<span>        y <span class="op">=</span> <span class="st">"Proportion"</span>, </span>
<span>        x <span class="op">=</span> <span class="st">"ANC Type"</span>,</span>
<span>        title <span class="op">=</span> <span class="st">"Distribution of the ANC method used and perinatal deaths"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Analysis-of-categorical-data_files/figure-html/unnamed-chunk-15-1.png" width="576"></div>
<p>The cell proportions are not uniform. The proportion of deaths in those who used
the old and anc methods is about 11.0% and 5.9% respectively. Is this enough
evidence to conclude the new is better than the old in the population? This
question we would have to answer using a formal statistical test.</p>
<p>Test for independence for tabular data often entails the use of the Chi-squared
test and/or Fisher’s exact test. Independence here simply means when one has
one variable one cannot predict the other variable.</p>
<p>Next, we apply the chi-squared test after we have verified that our data does
not violate the assumption required for its use. These are.</p>
<ol style="list-style-type: decimal">
<li>The data was obtained randomly from the population</li>
<li>The variables under study are categorical</li>
<li>Each observation fits into only one cell of the table</li>
<li>The expected values in each cell of the tabular data are at least 5</li>
</ol>
<p>Our data does not violate any of these so we go ahead to state the null
hypothesis.</p>
<blockquote>
<p>H0: There is no difference in the proportion of perinatal deaths between mothers who used the new and old ANC methods.</p>
</blockquote>
<p>And perform the test</p>
<div class="sourceCode" id="cb186"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_anc</span> <span class="op">%$%</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">anc</span>, <span class="va">death</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/generics/man/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-16">
<caption style="caption-side: top; text-align: center;">
<span id="tab:unnamed-chunk-16">Table 6.11: </span> </caption>
<col>
<col>
<col>
<col>
<tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 0pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">statistic</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">p.value</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">parameter</th>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">method</th>
</tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 0pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">5.29</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">0.0214</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">1</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">Pearson's Chi-squared test with Yates' continuity correction</td>
</tr>
</table></div>
<p>The test above yields a relatively small p-value compared to a significance
level of 0.05, indicating the null hypothesis of independence of the cell
proportions are unlikely. In other words, the cell proportions differ
significantly, the old method can be said to result in significantly higher
perinatal deaths compared to the new method.</p>
</div>
<div id="chi-squared-test-for-trend" class="section level3" number="14.3.3">
<h3>
<span class="header-section-number">14.3.3</span> Chi-squared test for trend<a class="anchor" aria-label="anchor" href="#chi-squared-test-for-trend"><i class="fas fa-link"></i></a>
</h3>
<p>Often there arise situations in categorical data analysis where the objective is
not to just see a difference in proportions as a Chi-squared test for independence
or Fisher’s test does but to determine any trend in the proportions seen. Here
the Chi-squared test for trend is often employed.</p>
<p>For example, in a study to determine the proportion of persons having eye changes
the following data was obtained: 4 out of 42 persons aged less than 45yrs, 7 out
of 43 aged between 46yrs and 55yrs, 12 out of 46 aged between 56yrs and 65yrs and
15 out of 44 aged more than 65yrs. First, we input these into R and calculate the percentages with the eye changes.</p>
<div class="sourceCode" id="cb187"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">No.eye</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">7</span>,<span class="fl">12</span>,<span class="fl">15</span><span class="op">)</span></span>
<span><span class="va">No.studied</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">42</span>, <span class="fl">43</span>, <span class="fl">46</span>, <span class="fl">44</span><span class="op">)</span></span></code></pre></div>
<p>Next, we determine the percentage of those with eye changes for each age group</p>
<div class="sourceCode" id="cb188"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Perc.eye</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">No.eye</span><span class="op">/</span><span class="va">No.studied</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Next, we form a matrix showing the number of persons with eye changes, the number
of persons studied and the percentage of persons with eye changes for each age
group.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="analysis-of-categorical-data.html#cb189-1" tabindex="-1"></a><span class="fu">names</span>(No.eye)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"&lt;=45yrs"</span>,<span class="st">"46-55yrs"</span>,<span class="st">"56-65yrs"</span>,<span class="st">"&gt;65yrs"</span>)</span>
<span id="cb189-2"><a href="analysis-of-categorical-data.html#cb189-2" tabindex="-1"></a><span class="fu">cbind</span>(No.eye, No.studied, Perc.eye)</span>
<span id="cb189-3"><a href="analysis-of-categorical-data.html#cb189-3" tabindex="-1"></a>         No.eye No.studied Perc.eye</span>
<span id="cb189-4"><a href="analysis-of-categorical-data.html#cb189-4" tabindex="-1"></a><span class="sc">&lt;=</span>45yrs       <span class="dv">4</span>         <span class="dv">42</span>      <span class="fl">9.5</span></span>
<span id="cb189-5"><a href="analysis-of-categorical-data.html#cb189-5" tabindex="-1"></a><span class="dv">46</span><span class="sc">-</span>55yrs      <span class="dv">7</span>         <span class="dv">43</span>     <span class="fl">16.3</span></span>
<span id="cb189-6"><a href="analysis-of-categorical-data.html#cb189-6" tabindex="-1"></a><span class="dv">56</span><span class="sc">-</span>65yrs     <span class="dv">12</span>         <span class="dv">46</span>     <span class="fl">26.1</span></span>
<span id="cb189-7"><a href="analysis-of-categorical-data.html#cb189-7" tabindex="-1"></a><span class="sc">&gt;</span>65yrs       <span class="dv">15</span>         <span class="dv">44</span>     <span class="fl">34.1</span></span></code></pre></div>
<p>From the analysis above it can be said that the proportions of persons with eye
changes increases with age. However, to determine if this apparent rise could be
a chance finding we apply the Chi-Squared test after we confirm the data does not
violate the assumptions for its use. The condition for its use is like the
chi-squared test for independent data but with an addition that at least one of
the variables must be ordered. Now satisfied that our data satisfies the
conditions we state the null hypothesis.</p>
<blockquote>
<p>H0: There is no trend in the eye changes with increasing age</p>
</blockquote>
<p>Next, we put it to the formal test</p>
<div class="sourceCode" id="cb190"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/prop.trend.test.html">prop.trend.test</a></span><span class="op">(</span><span class="va">No.eye</span>, <span class="va">No.studied</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/generics/man/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-20">
<caption style="caption-side: top; text-align: center;">
<span id="tab:unnamed-chunk-20">Table 13.4: </span> </caption>
<col>
<col>
<col>
<col>
<tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 0pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">statistic</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">p.value</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">parameter</th>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">method</th>
</tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 0pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">8.86</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">0.00291</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">1</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">Chi-squared Test for Trend in Proportions</td>
</tr>
</table></div>
<p>With a p-value less than 0.05, we reject the H0 and conclude that there a
significant trend (upward because we know it is) in developing eye changes with
increasing age.</p>
</div>
</div>
<div id="fishers-exact-test" class="section level2" number="14.4">
<h2>
<span class="header-section-number">14.4</span> Fisher’s Exact test<a class="anchor" aria-label="anchor" href="#fishers-exact-test"><i class="fas fa-link"></i></a>
</h2>
<p>A valid conclusion from the use of the chi-squared test can only be guaranteed if the counts in all the cells of the table in question are equal to or greater than 5. Whenever the count or value in any of the cells is below 5, Fisher’s exact test must be used instead. Its use and interpretation are similar to the chi-squared test and are demonstrated with the ANCdata as below.</p>
<div class="sourceCode" id="cb191"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_anc</span> <span class="op">%$%</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">anc</span>, <span class="va">death</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/generics/man/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-21">
<caption style="caption-side: top; text-align: center;">
<span id="tab:unnamed-chunk-21">Table 13.5: </span> </caption>
<col>
<col>
<col>
<col>
<col>
<col>
<tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 0pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">estimate</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">p.value</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">conf.low</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">conf.high</th>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">method</th>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 6pt; font-weight: bold; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">alternative</th>
</tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 0pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">0.514</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">0.0191</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">0.282</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">0.908</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 6pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">Fisher's Exact Test for Count Data</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 2pt 0pt 2pt 6pt; font-weight: normal; font-family: Arial, Times New Roman, Times, Serif; font-size: 11pt;">two.sided</td>
</tr>
</table></div>
<p>The p-value here is quite like that obtained by the chi-squared test but not the
same. However, the conclusion remains the same. The added advantage of using
<code><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test()</a></code> is the provision of the odds ratio and its 95% confidence
interval. The odds ratio will be explained in subsequent sections.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="analysis-of-numeric-data.html"><span class="header-section-number">13</span> Analysis of numeric data</a></div>
<div class="next"><a href="risk-and-odds.html"><span class="header-section-number">15</span> Risk and Odds</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#analysis-of-categorical-data"><span class="header-section-number">14</span> Analysis of categorical data</a></li>
<li>
<a class="nav-link" href="#one-sample-binomial-test"><span class="header-section-number">14.1</span> One-sample binomial test</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#one-sample-proportion-confidence-interval"><span class="header-section-number">14.1.1</span> One sample proportion: Confidence interval</a></li>
<li><a class="nav-link" href="#one-sample-proportion-hypothesis-testing"><span class="header-section-number">14.1.2</span> One sample proportion: Hypothesis testing</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#two-or-more-sample-binomial-test"><span class="header-section-number">14.2</span> Two or more sample binomial test</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#two-sample-proportion-hypothesis-testing"><span class="header-section-number">14.2.1</span> Two sample proportion: Hypothesis testing</a></li></ul>
</li>
<li>
<a class="nav-link" href="#chi-squared-test"><span class="header-section-number">14.3</span> Chi-squared test</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#chi-squared-goodness-of-fit-test"><span class="header-section-number">14.3.1</span> Chi-squared goodness of fit test</a></li>
<li><a class="nav-link" href="#chi-squared-test-for-independent-data"><span class="header-section-number">14.3.2</span> Chi-squared test for independent data</a></li>
<li><a class="nav-link" href="#chi-squared-test-for-trend"><span class="header-section-number">14.3.3</span> Chi-squared test for trend</a></li>
</ul>
</li>
<li><a class="nav-link" href="#fishers-exact-test"><span class="header-section-number">14.4</span> Fisher’s Exact test</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/sbnguah/MedStatsBook/blob/master/Analysis-of-categorical-data.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/sbnguah/MedStatsBook/edit/master/Analysis-of-categorical-data.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Medical Statistics using R</strong>" was written by Samuel Blay Nguah. It was last built on 2023-09-22.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
