<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 11 Analysis of numeric data | Medical Statistics using R</title>
<meta name="author" content="Samuel Blay Nguah">
<meta name="description" content="So far, we have dealt with descriptive statistics and the analysis of the sample data collected. However, the bane of most statistical analysis is to make inferences about the population as a...">
<meta name="generator" content="bookdown 0.34 with bs4_book()">
<meta property="og:title" content="Chapter 11 Analysis of numeric data | Medical Statistics using R">
<meta property="og:type" content="book">
<meta property="og:url" content="https://medstastwithr.netlify.app/analysis-of-numeric-data.html">
<meta property="og:description" content="So far, we have dealt with descriptive statistics and the analysis of the sample data collected. However, the bane of most statistical analysis is to make inferences about the population as a...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 11 Analysis of numeric data | Medical Statistics using R">
<meta name="twitter:description" content="So far, we have dealt with descriptive statistics and the analysis of the sample data collected. However, the bane of most statistical analysis is to make inferences about the population as a...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="libs/tabwid-1.1.3/tabwid.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Medical Statistics using R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> About</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">2</span> Introduction</a></li>
<li><a class="" href="statistical-data-types.html"><span class="header-section-number">3</span> Statistical data types</a></li>
<li><a class="" href="r-data-types.html"><span class="header-section-number">4</span> R data types</a></li>
<li><a class="" href="hello-r.html"><span class="header-section-number">5</span> Hello R</a></li>
<li><a class="" href="data-structures-in-r.html"><span class="header-section-number">6</span> Data Structures in R</a></li>
<li><a class="" href="data-import-export.html"><span class="header-section-number">7</span> Data import &amp; export</a></li>
<li><a class="" href="data-wrangling.html"><span class="header-section-number">8</span> Data wrangling</a></li>
<li><a class="" href="data-cleaning.html"><span class="header-section-number">9</span> Data Cleaning</a></li>
<li><a class="" href="descriptive-statistics.html"><span class="header-section-number">10</span> Descriptive Statistics</a></li>
<li><a class="active" href="analysis-of-numeric-data.html"><span class="header-section-number">11</span> Analysis of numeric data</a></li>
<li><a class="" href="risk-and-odds.html"><span class="header-section-number">12</span> Risk and Odds</a></li>
<li><a class="" href="confounding-and-interaction.html"><span class="header-section-number">13</span> Confounding and Interaction</a></li>
<li><a class="" href="linear-regression.html"><span class="header-section-number">14</span> Linear Regression</a></li>
<li><a class="" href="analysis-of-variance.html"><span class="header-section-number">15</span> Analysis of Variance</a></li>
<li><a class="" href="ordinal-logistic-regression.html"><span class="header-section-number">16</span> Ordinal logistic regression</a></li>
<li><a class="" href="survival-analysis.html"><span class="header-section-number">17</span> Survival analysis</a></li>
<li><a class="" href="cox-regression.html"><span class="header-section-number">18</span> Cox Regression</a></li>
<li><a class="" href="blocks.html"><span class="header-section-number">19</span> Blocks</a></li>
<li><a class="" href="footnotes-and-citations.html"><span class="header-section-number">20</span> Footnotes and citations</a></li>
<li><a class="" href="cross.html"><span class="header-section-number">21</span> Cross-references</a></li>
<li><a class="" href="parts.html"><span class="header-section-number">22</span> Parts</a></li>
<li><a class="" href="sharing-your-book.html"><span class="header-section-number">23</span> Sharing your book</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/sbnguah/MedStatsBook">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="analysis-of-numeric-data" class="section level1" number="11">
<h1>
<span class="header-section-number">11</span> Analysis of numeric data<a class="anchor" aria-label="anchor" href="#analysis-of-numeric-data"><i class="fas fa-link"></i></a>
</h1>
<p>So far, we have dealt with descriptive statistics and the analysis of the sample
data collected. However, the bane of most statistical analysis is to make
inferences about the population as a whole. In this section, we mainly do an
inferential analysis of continuous variables.</p>
<div id="confidence-interval-of-a-mean" class="section level2" number="11.1">
<h2>
<span class="header-section-number">11.1</span> Confidence interval of a mean<a class="anchor" aria-label="anchor" href="#confidence-interval-of-a-mean"><i class="fas fa-link"></i></a>
</h2>
<p>To determine the confidence interval of the mean of a numeric variable in R, we
use the One Sample Student’s T-test. The assumptions for the validity of this
test are:</p>
<ol style="list-style-type: decimal">
<li>The sample should have been randomly chosen</li>
<li>The population distribution of the variable should be normal. This can be
assumed to be present if
<ul>
<li>The distribution of the population is known to be normally distributed</li>
<li>The population distribution should have one mode, symmetric, without
outliers and a sample size of 15 or less</li>
<li>The population distribution should be moderately skewed, without outliers,
and have one mode and with a sample size between 16 and 40</li>
<li>The sample size is more than 40 and the data has no outliers.</li>
</ul>
</li>
</ol>
<p>With our sample considered to be randomly selected and a sample size of 140, we
apply the One-sample T-test as below.</p>
<p>We first import the data</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="analysis-of-numeric-data.html#cb132-1" tabindex="-1"></a>df_data1 <span class="ot">&lt;-</span> </span>
<span id="cb132-2"><a href="analysis-of-numeric-data.html#cb132-2" tabindex="-1"></a>    <span class="fu">read_delim</span>(</span>
<span id="cb132-3"><a href="analysis-of-numeric-data.html#cb132-3" tabindex="-1"></a>        <span class="at">file =</span> <span class="st">"./Data/data1.txt"</span>, </span>
<span id="cb132-4"><a href="analysis-of-numeric-data.html#cb132-4" tabindex="-1"></a>        <span class="at">delim =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,</span>
<span id="cb132-5"><a href="analysis-of-numeric-data.html#cb132-5" tabindex="-1"></a>        <span class="at">col_types =</span> <span class="fu">c</span>(<span class="st">"c"</span>, <span class="st">"f"</span>, <span class="st">"i"</span>,<span class="st">"i"</span>)</span>
<span id="cb132-6"><a href="analysis-of-numeric-data.html#cb132-6" tabindex="-1"></a>    )</span>
<span id="cb132-7"><a href="analysis-of-numeric-data.html#cb132-7" tabindex="-1"></a></span>
<span id="cb132-8"><a href="analysis-of-numeric-data.html#cb132-8" tabindex="-1"></a><span class="fu">glimpse</span>(df_data1)</span>
<span id="cb132-9"><a href="analysis-of-numeric-data.html#cb132-9" tabindex="-1"></a>Rows<span class="sc">:</span> <span class="dv">140</span></span>
<span id="cb132-10"><a href="analysis-of-numeric-data.html#cb132-10" tabindex="-1"></a>Columns<span class="sc">:</span> <span class="dv">4</span></span>
<span id="cb132-11"><a href="analysis-of-numeric-data.html#cb132-11" tabindex="-1"></a><span class="sc">$</span> id     <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="st">"125"</span>, <span class="st">"62"</span>, <span class="st">"112"</span>, <span class="st">"29"</span>, <span class="st">"27"</span>, <span class="st">"131"</span>, <span class="st">"83"</span>…</span>
<span id="cb132-12"><a href="analysis-of-numeric-data.html#cb132-12" tabindex="-1"></a><span class="sc">$</span> sex    <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="st">"Male"</span>, <span class="st">"Female"</span>, <span class="st">"Female"</span>, <span class="st">"Female"</span>, <span class="st">"Male…</span></span>
<span id="cb132-13"><a href="analysis-of-numeric-data.html#cb132-13" tabindex="-1"></a><span class="st">$ weight &lt;dbl&gt; 7, 11, 13, 20, 12, 9, 9, 4, 14, 13, 14, 22,…</span></span>
<span id="cb132-14"><a href="analysis-of-numeric-data.html#cb132-14" tabindex="-1"></a><span class="st">$ height &lt;dbl&gt; 64, 96, 115, 106, 94, 78, 77, 59, 96, 92, 9…</span></span></code></pre></div>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_data1</span> <span class="op">%$%</span> </span>
<span>    <span class="fu">epiDisplay</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/epiDisplay/man/ci.html">ci</a></span><span class="op">(</span><span class="va">height</span><span class="op">)</span><span class="op">%&gt;%</span> </span>
<span>    <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>booktabs <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left"></th>
<th align="right">n</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">se</th>
<th align="right">lower95ci</th>
<th align="right">upper95ci</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left"></td>
<td align="right">139</td>
<td align="right">90.85612</td>
<td align="right">21.34179</td>
<td align="right">1.810187</td>
<td align="right">87.27683</td>
<td align="right">94.4354</td>
</tr></tbody>
</table></div>
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_data1</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">meantables</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/meantables/man/mean_table.html">mean_table</a></span><span class="op">(</span><span class="va">height</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>booktabs <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">response_var</th>
<th align="right">n</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">sem</th>
<th align="right">lcl</th>
<th align="right">ucl</th>
<th align="right">min</th>
<th align="right">max</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">height</td>
<td align="right">139</td>
<td align="right">90.86</td>
<td align="right">21.34</td>
<td align="right">1.810187</td>
<td align="right">87.28</td>
<td align="right">94.44</td>
<td align="right">49</td>
<td align="right">137</td>
</tr></tbody>
</table></div>
<p>For sex stratified confidence intervals we have</p>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_data1</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">sex</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">meantables</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/meantables/man/mean_table.html">mean_table</a></span><span class="op">(</span><span class="va">height</span><span class="op">)</span><span class="op">%&gt;%</span> </span>
<span>    <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>booktabs <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="16%">
<col width="12%">
<col width="12%">
<col width="3%">
<col width="7%">
<col width="7%">
<col width="11%">
<col width="7%">
<col width="7%">
<col width="5%">
<col width="5%">
</colgroup>
<thead><tr class="header">
<th align="left">response_var</th>
<th align="left">group_var</th>
<th align="left">group_cat</th>
<th align="right">n</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">sem</th>
<th align="right">lcl</th>
<th align="right">ucl</th>
<th align="right">min</th>
<th align="right">max</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">height</td>
<td align="left">sex</td>
<td align="left">Female</td>
<td align="right">63</td>
<td align="right">92.16</td>
<td align="right">22.98</td>
<td align="right">2.894829</td>
<td align="right">86.37</td>
<td align="right">97.95</td>
<td align="right">49</td>
<td align="right">137</td>
</tr>
<tr class="even">
<td align="left">height</td>
<td align="left">sex</td>
<td align="left">Male</td>
<td align="right">76</td>
<td align="right">89.78</td>
<td align="right">19.98</td>
<td align="right">2.291372</td>
<td align="right">85.21</td>
<td align="right">94.34</td>
<td align="right">55</td>
<td align="right">131</td>
</tr>
</tbody>
</table></div>
</div>
<div id="comparing-the-mean-to-a-hypothesised-value" class="section level2" number="11.2">
<h2>
<span class="header-section-number">11.2</span> Comparing the mean to a hypothesised value<a class="anchor" aria-label="anchor" href="#comparing-the-mean-to-a-hypothesised-value"><i class="fas fa-link"></i></a>
</h2>
<p>Assuming the objective of the data collected was to determine if the average
weight of our population was similar to a population with a known mean weight of
14kgs.</p>
<p>Our null hypothesis is:</p>
<blockquote>
<p>H0: There is no difference in mean weight between our population and a
population with mean weight of 14kgs.</p>
</blockquote>
<p>To test this hypothesis we use the One sample t-test after we have satisfied
ourselves that the assumptions for its use have been met.</p>
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_data1</span> <span class="op">%&gt;%</span> </span>
<span>     <span class="fu">rstatix</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/t_test.html">t_test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">weight</span><span class="op">~</span><span class="fl">1</span>, mu<span class="op">=</span><span class="fl">14</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>     <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>booktabs <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">.y.</th>
<th align="left">group1</th>
<th align="left">group2</th>
<th align="right">n</th>
<th align="right">statistic</th>
<th align="right">df</th>
<th align="right">p</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">weight</td>
<td align="left">1</td>
<td align="left">null model</td>
<td align="right">140</td>
<td align="right">-3.324013</td>
<td align="right">139</td>
<td align="right">0.00113</td>
</tr></tbody>
</table></div>
<p>The p-value of 0.001 is the probability that our sample could have come from a
population with a mean weight of 14kgs. Since this is very small we reject the
null H0 at a 5% significance level and conclude that our population mean weight
is significantly different from 14kgs.
The confidence interval generated is that of our sample mean. With the
hypothesized value of
14kgs outside the confidence interval of the mean we conclude that there is
insuficient evidence to suggest that the mean weight of our population is 14kgs.</p>
</div>
<div id="comparing-mean-of-two-independent-groups" class="section level2" number="11.3">
<h2>
<span class="header-section-number">11.3</span> Comparing mean of two independent groups<a class="anchor" aria-label="anchor" href="#comparing-mean-of-two-independent-groups"><i class="fas fa-link"></i></a>
</h2>
<p>This is possibly the most common use for the t-test. To compare the mean weights
of the males and female in our study we come up with</p>
<blockquote>
<p>H0: There is no difference in weight between the males and females in our
population.</p>
</blockquote>
<p>To test this assertion we first determine if our sample fits the assumption for
the use of the Two sample t-test. These are:</p>
<ol style="list-style-type: decimal">
<li>The sample should have been randomly chosen</li>
<li>The two samples are completely independent</li>
<li>Each population is at least 20 times larger than its respective sample.</li>
<li>The population distribution of the variable should be normal. This can be assumed to be
present if
<ul>
<li>The distribution of the population is known to be normal</li>
<li>The population distribution should have one mode, symmetric, without outliers and
a sample size of 15 or less</li>
<li>The population distribution should be moderately skewed, without outliers, have
one mode and with a sample size between 16 and 40</li>
<li>The sample size is more than 40 and data has no outliers.</li>
</ul>
</li>
</ol>
<p>Our data fulfils all the criteria above hence we apply the test</p>
<div class="sourceCode" id="cb137"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_data1</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">rstatix</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/t_test.html">t_test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">weight</span> <span class="op">~</span> <span class="va">sex</span>, detailed <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">%&gt;%</span> </span>
<span>    <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>booktabs <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table style="width:100%;" class="table table-sm">
<colgroup>
<col width="7%">
<col width="8%">
<col width="8%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="2%">
<col width="2%">
<col width="8%">
<col width="4%">
<col width="7%">
<col width="9%">
<col width="8%">
<col width="5%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th align="right">estimate</th>
<th align="right">estimate1</th>
<th align="right">estimate2</th>
<th align="left">.y.</th>
<th align="left">group1</th>
<th align="left">group2</th>
<th align="right">n1</th>
<th align="right">n2</th>
<th align="right">statistic</th>
<th align="right">p</th>
<th align="right">df</th>
<th align="right">conf.low</th>
<th align="right">conf.high</th>
<th align="left">method</th>
<th align="left">alternative</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">1.305921</td>
<td align="right">12.9375</td>
<td align="right">11.63158</td>
<td align="left">weight</td>
<td align="left">Female</td>
<td align="left">Male</td>
<td align="right">64</td>
<td align="right">76</td>
<td align="right">1.196345</td>
<td align="right">0.234</td>
<td align="right">117.1908</td>
<td align="right">-0.8558831</td>
<td align="right">3.467725</td>
<td align="left">T-test</td>
<td align="left">two.sided</td>
</tr></tbody>
</table></div>
<p>With a relatively high p-value we conclude that there is insufficient evidence
to refute null hypothesis. In other words there is insufficient evidence to
conclude the mean weights of males and females differ in the study population.
Note that in our sample however females appear heavier than males as shown by
the last two lines of the output above.</p>
<p>The confidence interval determined above (-0.86 to 3.47) is actually that for
the mean sample difference between females and males. Since the confidence
interval contains the null value from H0 above i.e. 0, we conclude that there
isn’t enough evidence of a difference in mean weight between the two sexes.
Hence both the confidence interval and p-value come to similar conclusions.</p>
</div>
<div id="comparing-means-of-paired-observations" class="section level2" number="11.4">
<h2>
<span class="header-section-number">11.4</span> Comparing means of paired observations<a class="anchor" aria-label="anchor" href="#comparing-means-of-paired-observations"><i class="fas fa-link"></i></a>
</h2>
<p>In this section we use the <code>bread.txt</code> data which has the weight in grams before
and after baking some loaves of bread. A description of the variables is
contained in the data file. Paired observations occur in circumstances where
repeated measurement are done on the same object or data collected has some
characteristics in common. For the bread data the same bread is weighed before
and after baking. Determining if there is a significant difference between the
two measurements requires the use of the Paired t-test. As always be begin by
importing the data</p>
<p>Next we determine the structure of the data frame df2</p>
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_bread</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"./Data/bread.txt"</span>, sep<span class="op">=</span><span class="st">"\t"</span>, header<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p>And then summarize it</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="analysis-of-numeric-data.html#cb139-1" tabindex="-1"></a>df_bread <span class="sc">%&gt;%</span> summarytools<span class="sc">::</span><span class="fu">dfSummary</span>(<span class="at">graph.col =</span> F)</span>
<span id="cb139-2"><a href="analysis-of-numeric-data.html#cb139-2" tabindex="-1"></a>Data Frame Summary  </span>
<span id="cb139-3"><a href="analysis-of-numeric-data.html#cb139-3" tabindex="-1"></a>df_bread  </span>
<span id="cb139-4"><a href="analysis-of-numeric-data.html#cb139-4" tabindex="-1"></a>Dimensions<span class="sc">:</span> <span class="dv">399</span> x <span class="dv">5</span>  </span>
<span id="cb139-5"><a href="analysis-of-numeric-data.html#cb139-5" tabindex="-1"></a>Duplicates<span class="sc">:</span> <span class="dv">0</span>  </span>
<span id="cb139-6"><a href="analysis-of-numeric-data.html#cb139-6" tabindex="-1"></a></span>
<span id="cb139-7"><a href="analysis-of-numeric-data.html#cb139-7" tabindex="-1"></a><span class="sc">----------------------------------------------------------------------------------------</span></span>
<span id="cb139-8"><a href="analysis-of-numeric-data.html#cb139-8" tabindex="-1"></a>No   Variable      Stats <span class="sc">/</span> Values             <span class="fu">Freqs</span> (% of Valid)    Valid      Missing  </span>
<span id="cb139-9"><a href="analysis-of-numeric-data.html#cb139-9" tabindex="-1"></a><span class="sc">----</span> <span class="sc">-------------</span> <span class="sc">--------------------------</span> <span class="sc">---------------------</span> <span class="sc">----------</span> <span class="sc">---------</span></span>
<span id="cb139-10"><a href="analysis-of-numeric-data.html#cb139-10" tabindex="-1"></a><span class="dv">1</span>    sid           <span class="fu">Mean</span> (sd) <span class="sc">:</span> <span class="dv">200</span> (<span class="fl">115.3</span>)    <span class="dv">399</span> distinct values   <span class="dv">399</span>        <span class="dv">0</span>        </span>
<span id="cb139-11"><a href="analysis-of-numeric-data.html#cb139-11" tabindex="-1"></a>     [integer]     min <span class="sc">&lt;</span> med <span class="sc">&lt;</span> max<span class="sc">:</span>           (Integer sequence)    (<span class="fl">100.0</span><span class="sc">%)   (0.0%</span>)   </span>
<span id="cb139-12"><a href="analysis-of-numeric-data.html#cb139-12" tabindex="-1"></a>                   <span class="dv">1</span> <span class="sc">&lt;</span> <span class="dv">200</span> <span class="sc">&lt;</span> <span class="dv">399</span>                                                        </span>
<span id="cb139-13"><a href="analysis-of-numeric-data.html#cb139-13" tabindex="-1"></a>                   <span class="fu">IQR</span> (CV) <span class="sc">:</span> <span class="dv">199</span> (<span class="fl">0.6</span>)                                                 </span>
<span id="cb139-14"><a href="analysis-of-numeric-data.html#cb139-14" tabindex="-1"></a></span>
<span id="cb139-15"><a href="analysis-of-numeric-data.html#cb139-15" tabindex="-1"></a><span class="dv">2</span>    type          <span class="fl">1.</span> maize                   <span class="dv">212</span> (<span class="fl">53.1</span>%)           <span class="dv">399</span>        <span class="dv">0</span>        </span>
<span id="cb139-16"><a href="analysis-of-numeric-data.html#cb139-16" tabindex="-1"></a>     [character]   <span class="fl">2.</span> wheat                   <span class="dv">187</span> (<span class="fl">46.9</span><span class="sc">%)           (100.0%</span>)   (<span class="fl">0.0</span>%)   </span>
<span id="cb139-17"><a href="analysis-of-numeric-data.html#cb139-17" tabindex="-1"></a></span>
<span id="cb139-18"><a href="analysis-of-numeric-data.html#cb139-18" tabindex="-1"></a><span class="dv">3</span>    before        <span class="fu">Mean</span> (sd) <span class="sc">:</span> <span class="fl">379.5</span> (<span class="fl">28.1</span>)   <span class="dv">120</span> distinct values   <span class="dv">399</span>        <span class="dv">0</span>        </span>
<span id="cb139-19"><a href="analysis-of-numeric-data.html#cb139-19" tabindex="-1"></a>     [integer]     min <span class="sc">&lt;</span> med <span class="sc">&lt;</span> max<span class="sc">:</span>                                 (<span class="fl">100.0</span><span class="sc">%)   (0.0%</span>)   </span>
<span id="cb139-20"><a href="analysis-of-numeric-data.html#cb139-20" tabindex="-1"></a>                   <span class="dv">304</span> <span class="sc">&lt;</span> <span class="dv">379</span> <span class="sc">&lt;</span> <span class="dv">479</span>                                                      </span>
<span id="cb139-21"><a href="analysis-of-numeric-data.html#cb139-21" tabindex="-1"></a>                   <span class="fu">IQR</span> (CV) <span class="sc">:</span> <span class="dv">40</span> (<span class="fl">0.1</span>)                                                  </span>
<span id="cb139-22"><a href="analysis-of-numeric-data.html#cb139-22" tabindex="-1"></a></span>
<span id="cb139-23"><a href="analysis-of-numeric-data.html#cb139-23" tabindex="-1"></a><span class="dv">4</span>    after         <span class="fu">Mean</span> (sd) <span class="sc">:</span> <span class="dv">217</span> (<span class="fl">29.8</span>)     <span class="dv">121</span> distinct values   <span class="dv">399</span>        <span class="dv">0</span>        </span>
<span id="cb139-24"><a href="analysis-of-numeric-data.html#cb139-24" tabindex="-1"></a>     [integer]     min <span class="sc">&lt;</span> med <span class="sc">&lt;</span> max<span class="sc">:</span>                                 (<span class="fl">100.0</span><span class="sc">%)   (0.0%</span>)   </span>
<span id="cb139-25"><a href="analysis-of-numeric-data.html#cb139-25" tabindex="-1"></a>                   <span class="dv">140</span> <span class="sc">&lt;</span> <span class="dv">215</span> <span class="sc">&lt;</span> <span class="dv">295</span>                                                      </span>
<span id="cb139-26"><a href="analysis-of-numeric-data.html#cb139-26" tabindex="-1"></a>                   <span class="fu">IQR</span> (CV) <span class="sc">:</span> <span class="dv">48</span> (<span class="fl">0.1</span>)                                                  </span>
<span id="cb139-27"><a href="analysis-of-numeric-data.html#cb139-27" tabindex="-1"></a></span>
<span id="cb139-28"><a href="analysis-of-numeric-data.html#cb139-28" tabindex="-1"></a><span class="dv">5</span>    oven          <span class="fl">1.</span> Firewood                <span class="dv">199</span> (<span class="fl">49.9</span>%)           <span class="dv">399</span>        <span class="dv">0</span>        </span>
<span id="cb139-29"><a href="analysis-of-numeric-data.html#cb139-29" tabindex="-1"></a>     [character]   <span class="fl">2.</span> Gas                     <span class="dv">200</span> (<span class="fl">50.1</span><span class="sc">%)           (100.0%</span>)   (<span class="fl">0.0</span>%)   </span>
<span id="cb139-30"><a href="analysis-of-numeric-data.html#cb139-30" tabindex="-1"></a><span class="sc">----------------------------------------------------------------------------------------</span></span></code></pre></div>
<p>Our next task is to compare the weight of the loaves of bread before and after
baking. We begin by looking at the mean and standard deviations of the two
weights.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="analysis-of-numeric-data.html#cb140-1" tabindex="-1"></a>df_bread <span class="sc">%&gt;%</span> </span>
<span id="cb140-2"><a href="analysis-of-numeric-data.html#cb140-2" tabindex="-1"></a>    <span class="fu">select</span>(before, after) <span class="sc">%&gt;%</span> </span>
<span id="cb140-3"><a href="analysis-of-numeric-data.html#cb140-3" tabindex="-1"></a>    rstatix<span class="sc">::</span><span class="fu">get_summary_stats</span>(<span class="at">type=</span> <span class="st">"mean_sd"</span>)</span>
<span id="cb140-4"><a href="analysis-of-numeric-data.html#cb140-4" tabindex="-1"></a><span class="co"># A tibble: 2 × 4</span></span>
<span id="cb140-5"><a href="analysis-of-numeric-data.html#cb140-5" tabindex="-1"></a>  variable     n  mean    sd</span>
<span id="cb140-6"><a href="analysis-of-numeric-data.html#cb140-6" tabindex="-1"></a>  <span class="sc">&lt;</span>fct<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb140-7"><a href="analysis-of-numeric-data.html#cb140-7" tabindex="-1"></a><span class="dv">1</span> before     <span class="dv">399</span>  <span class="fl">380.</span>  <span class="fl">28.1</span></span>
<span id="cb140-8"><a href="analysis-of-numeric-data.html#cb140-8" tabindex="-1"></a><span class="dv">2</span> after      <span class="dv">399</span>  <span class="fl">217.</span>  <span class="fl">29.8</span></span></code></pre></div>
<p>It is obvious that the mean weight of the bread before baking is much higher
than after however the standard deviations appear similar. For a formal test to
determine the difference in means we use the paired t-test. As before the we
state the assumptions of the paired t-test</p>
<ol style="list-style-type: decimal">
<li>The sample should have been randomly chosen</li>
<li>The two samples are not independent (they are related)</li>
<li>Each population is at least 20 times larger than its respective sample.</li>
<li>The population distribution of the difference between the two variables
should be normal.
This can be assumed to be present if
<ul>
<li>The distribution of the population is known to be normal</li>
<li>The population distribution should have one mode, symmetric, without
outliers and a sample size of 15 or less</li>
<li>The population distribution should be moderately skewed, without outliers,
have one mode and with a sample size between 16 and 40</li>
<li>The sample size is more than 40 and data has no outliers.</li>
</ul>
</li>
</ol>
<p>The only new assumption we need to evaluate here is the distribution of the
difference between the weights before and after. We do so below</p>
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_bread</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span>diff_in_wgt <span class="op">=</span> <span class="va">after</span> <span class="op">-</span> <span class="va">before</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">diff_in_wgt</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">10</span>, col <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Difference in weight"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Analysis-of-continuous-data_files/figure-html/unnamed-chunk-11-1.png" width="480"></div>
<p>Alternatively, we can perform a Shapiro-Wilk’s test for normality. This has H0
as not deviating from the normal distribution. This is done below</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="analysis-of-numeric-data.html#cb142-1" tabindex="-1"></a>df_bread <span class="sc">%&gt;%</span> </span>
<span id="cb142-2"><a href="analysis-of-numeric-data.html#cb142-2" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">diff_in_wgt =</span> after <span class="sc">-</span> before) <span class="sc">%&gt;%</span></span>
<span id="cb142-3"><a href="analysis-of-numeric-data.html#cb142-3" tabindex="-1"></a>    rstatix<span class="sc">::</span><span class="fu">shapiro_test</span>(<span class="at">vars =</span> <span class="st">"diff_in_wgt"</span>)</span>
<span id="cb142-4"><a href="analysis-of-numeric-data.html#cb142-4" tabindex="-1"></a><span class="co"># A tibble: 1 × 3</span></span>
<span id="cb142-5"><a href="analysis-of-numeric-data.html#cb142-5" tabindex="-1"></a>  variable    statistic     p</span>
<span id="cb142-6"><a href="analysis-of-numeric-data.html#cb142-6" tabindex="-1"></a>  <span class="sc">&lt;</span>chr<span class="sc">&gt;</span>           <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb142-7"><a href="analysis-of-numeric-data.html#cb142-7" tabindex="-1"></a><span class="dv">1</span> diff_in_wgt     <span class="fl">0.997</span> <span class="fl">0.636</span></span></code></pre></div>
<p>The output and graphical representation above shows our difference in weight is
literally normally distributed. We therefore go ahead to determine the
difference in mean weights. First we state our hypothesis</p>
<blockquote>
<p>H0: There is no change in weight of loaves of bread after baking</p>
</blockquote>
<p>And then perform the test after converting the data to the long format</p>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_bread</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">pivot_longer</span><span class="op">(</span></span>
<span>        cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">before</span>, <span class="va">after</span><span class="op">)</span>, </span>
<span>        names_to <span class="op">=</span> <span class="st">"time"</span>, </span>
<span>        values_to <span class="op">=</span> <span class="st">"weight"</span></span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">rstatix</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/t_test.html">t_test</a></span><span class="op">(</span></span>
<span>        formula <span class="op">=</span> <span class="va">weight</span><span class="op">~</span><span class="va">time</span>, </span>
<span>        paired <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        detailed <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span><span class="op">%&gt;%</span> </span>
<span>    <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>booktabs <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="10%">
<col width="7%">
<col width="7%">
<col width="7%">
<col width="4%">
<col width="4%">
<col width="10%">
<col width="3%">
<col width="4%">
<col width="10%">
<col width="10%">
<col width="7%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="right">estimate</th>
<th align="left">.y.</th>
<th align="left">group1</th>
<th align="left">group2</th>
<th align="right">n1</th>
<th align="right">n2</th>
<th align="right">statistic</th>
<th align="right">p</th>
<th align="right">df</th>
<th align="right">conf.low</th>
<th align="right">conf.high</th>
<th align="left">method</th>
<th align="left">alternative</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">-162.5213</td>
<td align="left">weight</td>
<td align="left">after</td>
<td align="left">before</td>
<td align="right">399</td>
<td align="right">399</td>
<td align="right">-94.07754</td>
<td align="right">0</td>
<td align="right">398</td>
<td align="right">-165.9175</td>
<td align="right">-159.1251</td>
<td align="left">T-test</td>
<td align="left">two.sided</td>
</tr></tbody>
</table></div>
<p>There was on average a 162.5g reduction in weight of the loaves of bread after
baking. This reduction has a 95% confidence interval of 159.1g to 165.9g and is
significantly different from 0 (p-value&lt;0.001).</p>
</div>
<div id="test-for-equality-of-variances" class="section level2" number="11.5">
<h2>
<span class="header-section-number">11.5</span> Test for equality of variances<a class="anchor" aria-label="anchor" href="#test-for-equality-of-variances"><i class="fas fa-link"></i></a>
</h2>
<p>In using the Student’s T-test to determine difference between the means of two
independent groups we need to be mindful of the variances of each group. The
computations done for the independent groups t-test are different when the
variances between the groups are similar or different. Therefore to determine
if the mean weight significantly differ between males and females we need to
determine and compare their variances. The function <code><a href="https://rdrr.io/r/stats/var.test.html">var.test()</a></code> in R compares
the variances between two independent groups and can be used for this
determination.Below we apply this F-test to compare the variances of the weight
for the two sexes. First we determine the variances.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="analysis-of-numeric-data.html#cb144-1" tabindex="-1"></a>df_data1 <span class="sc">%&gt;%</span> </span>
<span id="cb144-2"><a href="analysis-of-numeric-data.html#cb144-2" tabindex="-1"></a>    <span class="fu">group_by</span>(sex) <span class="sc">%&gt;%</span></span>
<span id="cb144-3"><a href="analysis-of-numeric-data.html#cb144-3" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="fu">across</span>(weight, <span class="fu">list</span>(<span class="at">var =</span> var, <span class="at">meam =</span> mean)))</span>
<span id="cb144-4"><a href="analysis-of-numeric-data.html#cb144-4" tabindex="-1"></a><span class="co"># A tibble: 2 × 3</span></span>
<span id="cb144-5"><a href="analysis-of-numeric-data.html#cb144-5" tabindex="-1"></a>  sex    weight_var weight_meam</span>
<span id="cb144-6"><a href="analysis-of-numeric-data.html#cb144-6" tabindex="-1"></a>  <span class="sc">&lt;</span>chr<span class="sc">&gt;</span>       <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>       <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb144-7"><a href="analysis-of-numeric-data.html#cb144-7" tabindex="-1"></a><span class="dv">1</span> Female       <span class="fl">50.8</span>        <span class="fl">12.9</span></span>
<span id="cb144-8"><a href="analysis-of-numeric-data.html#cb144-8" tabindex="-1"></a><span class="dv">2</span> Male         <span class="fl">30.2</span>        <span class="fl">11.6</span></span></code></pre></div>
<p>There seem to be a big difference between the variance of the weights for the
two sexes. That for the females is almost 1.7 times that of the males. To
determine if this is not a chance finding we apply a formal statistical test.
Here our</p>
<blockquote>
<p>H0: There is no difference in the variance of the weights for males and
females in our population</p>
</blockquote>
<p>The F-test actually tests the ratio of the variances not the difference. In that
regard our null value would be 1.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="analysis-of-numeric-data.html#cb145-1" tabindex="-1"></a>df_data1 <span class="sc">%&gt;%</span> </span>
<span id="cb145-2"><a href="analysis-of-numeric-data.html#cb145-2" tabindex="-1"></a>    <span class="fu">var.test</span>(<span class="at">formula =</span> weight<span class="sc">~</span>sex, <span class="at">data =</span> .) <span class="sc">%&gt;%</span> </span>
<span id="cb145-3"><a href="analysis-of-numeric-data.html#cb145-3" tabindex="-1"></a>    broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb145-4"><a href="analysis-of-numeric-data.html#cb145-4" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">booktabs =</span> <span class="cn">TRUE</span>)</span>
<span id="cb145-5"><a href="analysis-of-numeric-data.html#cb145-5" tabindex="-1"></a>Multiple parameters; naming those columns num.df, den.df</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="8%">
<col width="6%">
<col width="6%">
<col width="9%">
<col width="9%">
<col width="8%">
<col width="9%">
<col width="30%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="right">estimate</th>
<th align="right">num.df</th>
<th align="right">den.df</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">conf.low</th>
<th align="right">conf.high</th>
<th align="left">method</th>
<th align="left">alternative</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">1.682321</td>
<td align="right">63</td>
<td align="right">75</td>
<td align="right">1.682321</td>
<td align="right">0.0311132</td>
<td align="right">1.04865</td>
<td align="right">2.726112</td>
<td align="left">F test to compare two variances</td>
<td align="left">two.sided</td>
</tr></tbody>
</table></div>
<p>The significant p-value (at a significance level of 0.05) and a confidence
interval not containing 1 (the null value) implies there is very little evidence
that the variance between the two groups are the same (in other words they
differ significantly). In that case the conclusion from the previous analysis is
valid as R assumes the variances to be unequal by default if the <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code>
function is used.</p>
<p>Next we apply the same principle to the determine if the mean heights are
similar for males and females in our population. We first determine if the
variances are significantly different.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="analysis-of-numeric-data.html#cb146-1" tabindex="-1"></a>df_data1 <span class="sc">%&gt;%</span> </span>
<span id="cb146-2"><a href="analysis-of-numeric-data.html#cb146-2" tabindex="-1"></a>    <span class="fu">group_by</span>(sex) <span class="sc">%&gt;%</span></span>
<span id="cb146-3"><a href="analysis-of-numeric-data.html#cb146-3" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="fu">across</span>(height,</span>
<span id="cb146-4"><a href="analysis-of-numeric-data.html#cb146-4" tabindex="-1"></a>                     <span class="fu">list</span>(</span>
<span id="cb146-5"><a href="analysis-of-numeric-data.html#cb146-5" tabindex="-1"></a>                         <span class="at">var =</span> <span class="sc">~</span><span class="fu">var</span>(., <span class="at">na.rm=</span>T),</span>
<span id="cb146-6"><a href="analysis-of-numeric-data.html#cb146-6" tabindex="-1"></a>                         <span class="at">meam =</span> <span class="sc">~</span><span class="fu">mean</span>(., <span class="at">na.rm=</span>T))))</span>
<span id="cb146-7"><a href="analysis-of-numeric-data.html#cb146-7" tabindex="-1"></a><span class="co"># A tibble: 2 × 3</span></span>
<span id="cb146-8"><a href="analysis-of-numeric-data.html#cb146-8" tabindex="-1"></a>  sex    height_var height_meam</span>
<span id="cb146-9"><a href="analysis-of-numeric-data.html#cb146-9" tabindex="-1"></a>  <span class="sc">&lt;</span>chr<span class="sc">&gt;</span>       <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>       <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb146-10"><a href="analysis-of-numeric-data.html#cb146-10" tabindex="-1"></a><span class="dv">1</span> Female       <span class="fl">528.</span>        <span class="fl">92.2</span></span>
<span id="cb146-11"><a href="analysis-of-numeric-data.html#cb146-11" tabindex="-1"></a><span class="dv">2</span> Male         <span class="fl">399.</span>        <span class="fl">89.8</span></span></code></pre></div>
<p>From the results above the variance for the females look much higher (1.3 times)
than the males however we apply a test to formally determine this.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="analysis-of-numeric-data.html#cb147-1" tabindex="-1"></a>df_data1 <span class="sc">%&gt;%</span> </span>
<span id="cb147-2"><a href="analysis-of-numeric-data.html#cb147-2" tabindex="-1"></a>    <span class="fu">var.test</span>(<span class="at">formula =</span> height<span class="sc">~</span>sex, <span class="at">data =</span> .) <span class="sc">%&gt;%</span> </span>
<span id="cb147-3"><a href="analysis-of-numeric-data.html#cb147-3" tabindex="-1"></a>    broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb147-4"><a href="analysis-of-numeric-data.html#cb147-4" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">booktabs =</span> <span class="cn">TRUE</span>)</span>
<span id="cb147-5"><a href="analysis-of-numeric-data.html#cb147-5" tabindex="-1"></a>Multiple parameters; naming those columns num.df, den.df</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="8%">
<col width="6%">
<col width="6%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="29%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="right">estimate</th>
<th align="right">num.df</th>
<th align="right">den.df</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">conf.low</th>
<th align="right">conf.high</th>
<th align="left">method</th>
<th align="left">alternative</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">1.323066</td>
<td align="right">62</td>
<td align="right">75</td>
<td align="right">1.323066</td>
<td align="right">0.2460558</td>
<td align="right">0.8233775</td>
<td align="right">2.149616</td>
<td align="left">F test to compare two variances</td>
<td align="left">two.sided</td>
</tr></tbody>
</table></div>
<p>Both p-value and confidence interval conclude there is insufficient evidence to
say the two variances are different. To use the <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> function to determine
the possibility that mean height differ between males and females we specify
that variance is equal as below.</p>
<div class="sourceCode" id="cb148"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_data1</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">rstatix</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/t_test.html">t_test</a></span><span class="op">(</span></span>
<span>        formula <span class="op">=</span> <span class="va">height</span><span class="op">~</span><span class="va">sex</span>, </span>
<span>        var.equal <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        detailed <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span><span class="op">%&gt;%</span> </span>
<span>    <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>booktabs <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="7%">
<col width="8%">
<col width="8%">
<col width="6%">
<col width="6%">
<col width="6%">
<col width="2%">
<col width="2%">
<col width="8%">
<col width="5%">
<col width="3%">
<col width="8%">
<col width="8%">
<col width="6%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="right">estimate</th>
<th align="right">estimate1</th>
<th align="right">estimate2</th>
<th align="left">.y.</th>
<th align="left">group1</th>
<th align="left">group2</th>
<th align="right">n1</th>
<th align="right">n2</th>
<th align="right">statistic</th>
<th align="right">p</th>
<th align="right">df</th>
<th align="right">conf.low</th>
<th align="right">conf.high</th>
<th align="left">method</th>
<th align="left">alternative</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">2.382414</td>
<td align="right">92.15873</td>
<td align="right">89.77632</td>
<td align="left">height</td>
<td align="left">Female</td>
<td align="left">Male</td>
<td align="right">63</td>
<td align="right">76</td>
<td align="right">0.6538128</td>
<td align="right">0.514</td>
<td align="right">137</td>
<td align="right">-4.823105</td>
<td align="right">9.587934</td>
<td align="left">T-test</td>
<td align="left">two.sided</td>
</tr></tbody>
</table></div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="descriptive-statistics.html"><span class="header-section-number">10</span> Descriptive Statistics</a></div>
<div class="next"><a href="risk-and-odds.html"><span class="header-section-number">12</span> Risk and Odds</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#analysis-of-numeric-data"><span class="header-section-number">11</span> Analysis of numeric data</a></li>
<li><a class="nav-link" href="#confidence-interval-of-a-mean"><span class="header-section-number">11.1</span> Confidence interval of a mean</a></li>
<li><a class="nav-link" href="#comparing-the-mean-to-a-hypothesised-value"><span class="header-section-number">11.2</span> Comparing the mean to a hypothesised value</a></li>
<li><a class="nav-link" href="#comparing-mean-of-two-independent-groups"><span class="header-section-number">11.3</span> Comparing mean of two independent groups</a></li>
<li><a class="nav-link" href="#comparing-means-of-paired-observations"><span class="header-section-number">11.4</span> Comparing means of paired observations</a></li>
<li><a class="nav-link" href="#test-for-equality-of-variances"><span class="header-section-number">11.5</span> Test for equality of variances</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/sbnguah/MedStatsBook/blob/master/Analysis-of-continuous-data.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/sbnguah/MedStatsBook/edit/master/Analysis-of-continuous-data.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Medical Statistics using R</strong>" was written by Samuel Blay Nguah. It was last built on 2023-07-01.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
